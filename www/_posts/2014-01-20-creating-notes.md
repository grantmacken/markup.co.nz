---
title: creating notes
author: Grant MacKenzie
published: 2014-01-20T16:05:01
id: tag:markup.co.nz,2014-01-20:article:creating-notes
summary: Thoughts On Creating Notes and Syndicating to Twitter
categories: indieweb note
---

* A note is 'a #post with just plain text content'.
* A note will be short like a tweet. In fact a note can be seen as a tweet
  replacement.
* Notes are stored as atom entries. Like Articles my Notes content is wrapped as
  an atom entry and stored in the data archive collection
  ```/data/archive/[year]/[month]/[day]/[file-name]```.
* The stored atom *content* is plain/text.
* The stored atom id is a taguri with a note identifier. ```id:
  tag:markup.co.nz,2014-01-20:note:{file-name}```
* The notes file-name may be autogenerated or created by user
* The stored atom entry has a title but the note title may be semantically
  irrelevant. e.g. 'nth note for the day'


When syndicating Notes to Twitter
--------------------------------

**Categories and hash tags**: <br/> A note may belong to one or many categories.
When a note is syndicated to twitter, the md front-matter 'categories' become
hashtags appended to text. Conversely Hashtags in md content context become md
front-matter 'categories'.

**Note char count**: <br/> When calculating 140 char take into account 'text' +
hashtags + backlink ( todo url shorten 22 chars Twitter t.co's URL size) <br/>
*Text* : If a note char count doesn't fit twitters 140 chars then this will
become an **abbr note**. In this case the *summary* is used with a link
otherwise the summary is not relevant. <br/> *Backlink*: <br/>If *abbr note*
create a ellipsis ...  then a space then $url. in the form of a
[permashortlink](https://indiewebcamp.com/permashortlinks) Note: my shortlinks
are 17 chars ```markup.co.nz/2sm1``` until I get a short
 ccTLDs domain. The backlink
 [permashortlink](https://indiewebcamp.com/permashortlinks) is
expanded and redirected to a permalink
```archive/[year]/[month]/[day]/[file-name]`` <br/>If *not abbr note* then the
backlink can become a
[permashortcitation](https://indiewebcamp.com/permashortcitation) . (surrounded
with brackets) Note: Will not do unless I have a ccTLDs Not convinced this is
the best UX thing to do i.e. for my twitter visitors.


Editing And Web UX
------------------

Although notes are created as just plain text, the web view of the note will
contain hyperlinked  content.

A note is created in Komodo. ```new-post`` (ctrl-alt-n). The text format is
markdown, however unlike 'articles' the markdown text is not stored on the
server in an atom container as xhtml content but as text.

The text can contain [linkable
things](http://indiewebcamp.com/notes#Autolinking_and_embedding). The
transformation of the texts 'linkable things' to a
node with hyperlinks is done via a xquery regex functions.

Autolinked Linkable Things List
* URLS<br/>
```let $pattern := '(https?://[\da-z\.-]+\.[a-z\.]{2,6}[\da-z/-]+)'```<br/>
```let $replacement := '<a href="$1">$1</a>'```
* #hashtags<br/>
```let $pattern := "(^|\s)((#)([A-Za-z]+[A-Za-z0-9_]{1,15}))(\s|$)"```<br/>
```let $replacement := '<span>$1$3<a href="/tag/$4">$4</a>$5</span>'```
* @people   TODO
* dates?    TODO

Autoembed Linkable Things List
* images URLS TODO
* videos URLS TODO
* YouTube     TODO

POSSE Notes to twitter
----------------------

From komodo project workspace or from website?

From komodo.

1. For interacting with twitter I choose
[twython](https://github.com/ryanmcgrath/twython) <br/>
```sudo pip install twython```

2. Goto [https://dev.twitter.com/](https://dev.twitter.com/) Add your app. Make
sure the setting application type is ``` Read, Write and Access direct
messages``` before you create your access token. And don't worry about the
callback url.

3. Add Twitter auth tokens to build.properties file. Note build.properties not
under git control so not in public domain. So all usernames password etc can go
into the build.properties file.

4. We call the following python script passing the md file as input. It will
strip the front-matter out and post remaining content text to twitter

Post to Twitter via Twython with Python
--------------------------------------

    python
    import argparse
    import re
    import fileinput
    from configobj import ConfigObj
    from twython import Twython

    config = ConfigObj('build.properties')
    parser = argparse.ArgumentParser(description='Ony one arg')
    parser.add_argument('-i','--input', help='Input file name',required=True)
    args = parser.parse_args()
    print args.input
    source_file_content = open(args.input, 'r').read()
    frontMatterSub = re.compile("-{3}[\s\S]+-{3}", re.M)
    status_content = frontMatterSub.sub('', source_file_content).strip()

    APP_KEY = config.get('twitter.app.key')
    APP_SECRET = config.get('twitter.app.secret')
    OAUTH_TOKEN = config.get('twitter.oauth.token')
    OAUTH_TOKEN_SECRET = config.get('twitter.oauth.token_secret')
    twitter = Twython(APP_KEY, APP_SECRET,
                      OAUTH_TOKEN, OAUTH_TOKEN_SECRET)
    jsonResult = twitter.update_status(status=status_content)

From here we can grab the return id from the json response. Will add this to the
md front matter and be used to create a rel-syndication links.

  'Additionally the microformats2 class name u-syndication should also be placed
  on such hyperlinks from original posts (inside their h-entrymarkup/object) to
  their syndicated copies'  done


Ref:
* [POSSE Notes to Twitter Pseudocode](http://indiewebcamp.com/Twitter#POSSE_Notes_to_Twitter_Pseudocode)
* [twython](https://twython.readthedocs.org/en/latest/usage/basic_usage.html)
